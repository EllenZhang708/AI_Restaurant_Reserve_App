// MapleTable - Canadian Restaurant App
// üçÅ Built for Canada's diverse culinary landscape

class MapleTableApp {
    constructor() {
        this.currentLanguage = 'en';
        this.currentCity = 'toronto';
        this.restaurants = [];
        this.favorites = new Set();
        this.filters = {
            cuisine: 'all',
            priceRange: 'all',
            rating: 0,
            features: []
        };
        
        this.translations = {
            en: {
                'Discover Canada\'s Best Restaurants': 'Discover Canada\'s Best Restaurants',
                'Discover Canada\'s Culinary Diversity': 'Discover Canada\'s Culinary Diversity',
                'Featured This Week': 'Featured This Week',
                'Winter Menu': 'Winter Menu',
                'Canadian Cuisine': 'Canadian Cuisine',
                'Nearby Restaurants': 'Nearby Restaurants',
                'Search restaurants, cuisine, location...': 'Search restaurants, cuisine, location...',
                'All': 'All',
                'Canadian': 'Canadian',
                'Poutine': 'Poutine',
                'Maple': 'Maple',
                'Winter Warm': 'Winter Warm',
                'Halal': 'Halal',
                'Home': 'Home',
                'Search': 'Search',
                'Bookings': 'Bookings',
                'Favorites': 'Favorites',
                'Profile': 'Profile',
                'Load More': 'Load More',
                'Filters': 'Filters',
                'Canadian Classics': 'Canadian Classics',
                'Qu√©b√©cois': 'Qu√©b√©cois',
                'Maritime': 'Maritime',
                'Prairie BBQ': 'Prairie BBQ',
                'Indigenous': 'Indigenous',
                'Multicultural': 'Multicultural'
            },
            fr: {
                'Discover Canada\'s Best Restaurants': 'D√©couvrez les Meilleurs Restaurants du Canada',
                'Discover Canada\'s Culinary Diversity': 'D√©couvrez la Diversit√© Culinaire du Canada',
                'Featured This Week': '√Ä la Une Cette Semaine',
                'Winter Menu': 'Menu d\'Hiver',
                'Canadian Cuisine': 'Cuisine Canadienne',
                'Nearby Restaurants': 'Restaurants √† Proximit√©',
                'Search restaurants, cuisine, location...': 'Rechercher restaurants, cuisine, lieu...',
                'All': 'Tous',
                'Canadian': 'Canadien',
                'Poutine': 'Poutine',
                'Maple': '√ârable',
                'Winter Warm': 'Chaud d\'Hiver',
                'Halal': 'Halal',
                'Home': 'Accueil',
                'Search': 'Recherche',
                'Bookings': 'R√©servations',
                'Favorites': 'Favoris',
                'Profile': 'Profil',
                'Load More': 'Charger Plus',
                'Filters': 'Filtres',
                'Canadian Classics': 'Classiques Canadiens',
                'Qu√©b√©cois': 'Qu√©b√©cois',
                'Maritime': 'Maritime',
                'Prairie BBQ': 'BBQ des Prairies',
                'Indigenous': 'Autochtone',
                'Multicultural': 'Multiculturel'
            }
        };
        
        this.initializeApp();
    }
    
    initializeApp() {
        this.loadCanadianRestaurants();
        this.setupEventListeners();
        this.updateWeather();
        
        // ÈöêËóèÂêØÂä®Â±èÂπïÔºåÊòæÁ§∫‰∏ªÂ∫îÁî®
        setTimeout(() => {
            document.getElementById('splashScreen').style.display = 'none';
            document.getElementById('mainApp').style.display = 'block';
            this.renderRestaurants();
        }, 2500);
    }
    
    // Âä†ËΩΩÁúüÂÆûÁöÑÂä†ÊãøÂ§ßÈ§êÂéÖÊï∞ÊçÆ
    loadCanadianRestaurants() {
        this.restaurants = [
            // Toronto Restaurants
            {
                id: 1,
                name: 'The CN Tower Restaurant',
                nameF: 'Restaurant de la Tour CN',
                cuisine: 'Canadian Fine Dining',
                cuisineF: 'Grande Cuisine Canadienne',
                city: 'toronto',
                rating: 4.8,
                reviewCount: 2847,
                priceRange: 'CAD $80-120',
                image: 'https://images.unsplash.com/photo-1414235077428-338989a2e8c0?w=400&h=300&fit=crop',
                features: ['Heated Patio', 'City Views', 'Wheelchair Accessible', 'Valet Parking'],
                featuresF: ['Terrasse Chauff√©e', 'Vue sur la Ville', 'Accessible Fauteuil Roulant', 'Voiturier'],
                badges: ['Fine Dining', 'Iconic'],
                badgesF: ['Grande Cuisine', 'Iconique'],
                cuisine_type: 'canadian-classics',
                description: 'Revolving restaurant atop Toronto\'s iconic CN Tower with panoramic city views and premium Canadian cuisine featuring local ingredients.',
                descriptionF: 'Restaurant tournant au sommet de la Tour CN iconique de Toronto avec vue panoramique sur la ville et cuisine canadienne haut de gamme mettant en vedette des ingr√©dients locaux.',
                address: '290 Bremner Blvd, Toronto, ON M5V 3L9',
                phone: '(416) 362-5411',
                winterFeatures: ['Heated Interior', 'Hot Maple Cider', 'Winter Tasting Menu'],
                winterFeaturesF: ['Int√©rieur Chauff√©', 'Cidre d\'√ârable Chaud', 'Menu D√©gustation d\'Hiver']
            },
            {
                id: 2,
                name: 'Poutinerie Au Pied de Cochon',
                nameF: 'Poutinerie Au Pied de Cochon',
                cuisine: 'Qu√©b√©cois Comfort Food',
                cuisineF: 'Cuisine R√©confortante Qu√©b√©coise',
                city: 'toronto',
                rating: 4.6,
                reviewCount: 1523,
                priceRange: 'CAD $15-30',
                image: 'https://images.unsplash.com/photo-1630409346828-a22b0ba8b5bb?w=400&h=300&fit=crop',
                features: ['Authentic Poutine', 'Maple Syrup Dishes', 'Cozy Interior', 'Late Night'],
                featuresF: ['Poutine Authentique', 'Plats au Sirop d\'√ârable', 'Int√©rieur Chaleureux', 'Tard le Soir'],
                badges: ['Local Favorite', 'Authentic'],
                badgesF: ['Favori Local', 'Authentique'],
                cuisine_type: 'quebec-french',
                description: 'Authentic Qu√©b√©cois poutinerie serving traditional curds and gravy with creative toppings, plus maple syrup desserts.',
                descriptionF: 'Poutinerie qu√©b√©coise authentique servant fromage en grains et sauce traditionnels avec garnitures cr√©atives, plus desserts au sirop d\'√©rable.',
                address: '382 Queen Street West, Toronto, ON M5V 2A7',
                phone: '(416) 977-0998',
                winterFeatures: ['Hearty Portions', 'Hot Comfort Food', 'Warm Atmosphere'],
                winterFeaturesF: ['Portions G√©n√©reuses', 'Nourriture R√©confortante Chaude', 'Atmosph√®re Chaleureuse']
            },
            {
                id: 3,
                name: 'The Keg Mansion',
                nameF: 'Le Manoir Keg',
                cuisine: 'Canadian Steakhouse',
                cuisineF: 'Steakhouse Canadien',
                city: 'toronto',
                rating: 4.7,
                reviewCount: 3256,
                priceRange: 'CAD $50-85',
                image: 'https://images.unsplash.com/photo-1558618644-fcd25c85cd64?w=400&h=300&fit=crop',
                features: ['Alberta Beef', 'Historic Building', 'Full Bar', 'Private Dining'],
                featuresF: ['B≈ìuf d\'Alberta', 'B√¢timent Historique', 'Bar Complet', 'Salle Priv√©e'],
                badges: ['Premium Steaks', 'Historic'],
                badgesF: ['Steaks Haut de Gamme', 'Historique'],
                cuisine_type: 'prairie',
                description: 'Upscale steakhouse in historic mansion featuring premium Alberta beef, fresh seafood, and extensive Canadian wine list.',
                descriptionF: 'Steakhouse haut de gamme dans un manoir historique proposant du b≈ìuf d\'Alberta haut de gamme, des fruits de mer frais et une vaste carte de vins canadiens.',
                address: '515 Jarvis Street, Toronto, ON M4Y 2H9',
                phone: '(416) 964-6609',
                winterFeatures: ['Fireplace Dining', 'Rich Winter Menu', 'Warm Service'],
                winterFeaturesF: ['D√Æner au Coin du Feu', 'Menu d\'Hiver Riche', 'Service Chaleureux']
            },
            
            // Vancouver Restaurants
            {
                id: 4,
                name: 'Granville Island Public Market',
                nameF: 'March√© Public de Granville Island',
                cuisine: 'West Coast Fresh Market',
                cuisineF: 'March√© Frais de la C√¥te Ouest',
                city: 'vancouver',
                rating: 4.5,
                reviewCount: 8945,
                priceRange: 'CAD $8-25',
                image: 'https://images.unsplash.com/photo-1555396273-367ea4eb4db5?w=400&h=300&fit=crop',
                features: ['Fresh Seafood', 'Local Produce', 'Artisan Foods', 'Waterfront Views'],
                featuresF: ['Fruits de Mer Frais', 'Produits Locaux', 'Aliments Artisanaux', 'Vue sur l\'Eau'],
                badges: ['Fresh Market', 'Local'],
                badgesF: ['March√© Frais', 'Local'],
                cuisine_type: 'maritime',
                description: 'Iconic public market featuring fresh BC seafood, local produce, artisan breads, and specialty foods from over 50 vendors.',
                descriptionF: 'March√© public iconique proposant fruits de mer frais de la CB, produits locaux, pains artisanaux et aliments sp√©cialis√©s de plus de 50 vendeurs.',
                address: '1669 Johnston St, Vancouver, BC V6H 3R9',
                phone: '(604) 666-5784',
                winterFeatures: ['Indoor Market', 'Hot Soups', 'Fresh Oysters'],
                winterFeaturesF: ['March√© Int√©rieur', 'Soupes Chaudes', 'Hu√Ætres Fra√Æches']
            },
            {
                id: 5,
                name: 'Salmon n\' Bannock',
                nameF: 'Saumon et Bannique',
                cuisine: 'Indigenous Canadian',
                cuisineF: 'Autochtone Canadien',
                city: 'vancouver',
                rating: 4.9,
                reviewCount: 756,
                priceRange: 'CAD $35-65',
                image: 'https://images.unsplash.com/photo-1565299624946-b28f40a0ca4b?w=400&h=300&fit=crop',
                features: ['Wild Game', 'Traditional Bannock', 'Indigenous Ingredients', 'Cultural Experience'],
                featuresF: ['Gibier', 'Bannique Traditionnelle', 'Ingr√©dients Autochtones', 'Exp√©rience Culturelle'],
                badges: ['Indigenous', 'Cultural'],
                badgesF: ['Autochtone', 'Culturel'],
                cuisine_type: 'indigenous',
                description: 'First Nations restaurant showcasing traditional Indigenous cuisine with modern techniques, featuring wild game, seafood, and foraged ingredients.',
                descriptionF: 'Restaurant des Premi√®res Nations pr√©sentant la cuisine autochtone traditionnelle avec des techniques modernes, mettant en vedette gibier, fruits de mer et ingr√©dients de cueillette.',
                address: '1128 W Broadway, Vancouver, BC V6H 1G5',
                phone: '(604) 568-8971',
                winterFeatures: ['Hearty Stews', 'Traditional Teas', 'Warm Atmosphere'],
                winterFeaturesF: ['Rago√ªts Copieux', 'Th√©s Traditionnels', 'Atmosph√®re Chaleureuse']
            },
            
            // Montreal Restaurants
            {
                id: 6,
                name: 'Schwartz\'s Hebrew Delicatessen',
                nameF: 'Charcuterie H√©bra√Øque Schwartz\'s',
                cuisine: 'Montreal Deli',
                cuisineF: 'Charcuterie de Montr√©al',
                city: 'montreal',
                rating: 4.4,
                reviewCount: 12847,
                priceRange: 'CAD $15-35',
                image: 'https://images.unsplash.com/photo-1509440159596-0249088772ff?w=400&h=300&fit=crop',
                features: ['Smoked Meat', 'Historic Deli', 'Cash Only', 'No Reservations'],
                featuresF: ['Viande Fum√©e', 'Charcuterie Historique', 'Comptant Seulement', 'Pas de R√©servations'],
                badges: ['Historic', 'Famous'],
                badgesF: ['Historique', 'C√©l√®bre'],
                cuisine_type: 'quebec-french',
                description: 'Legendary Montreal institution since 1928, famous for hand-sliced smoked meat sandwiches and traditional Jewish deli fare.',
                descriptionF: 'Institution l√©gendaire de Montr√©al depuis 1928, c√©l√®bre pour ses sandwichs de viande fum√©e tranch√©e √† la main et sa cuisine de charcuterie juive traditionnelle.',
                address: '3895 Saint-Laurent Blvd, Montreal, QC H2W 1X9',
                phone: '(514) 842-4813',
                winterFeatures: ['Hot Smoked Meat', 'Warm Interior', 'Comfort Food'],
                winterFeaturesF: ['Viande Fum√©e Chaude', 'Int√©rieur Chaleureux', 'Nourriture R√©confortante']
            },
            {
                id: 7,
                name: 'Au Pied de Cochon',
                nameF: 'Au Pied de Cochon',
                cuisine: 'Quebecois Fine Dining',
                cuisineF: 'Grande Cuisine Qu√©b√©coise',
                city: 'montreal',
                rating: 4.7,
                reviewCount: 2156,
                priceRange: 'CAD $65-95',
                image: 'https://images.unsplash.com/photo-1559339352-11d035aa65de?w=400&h=300&fit=crop',
                features: ['Foie Gras', 'Duck Poutine', 'Maple Syrup', 'Rich Cuisine'],
                featuresF: ['Foie Gras', 'Poutine au Canard', 'Sirop d\'√ârable', 'Cuisine Riche'],
                badges: ['Celebrity Chef', 'Indulgent'],
                badgesF: ['Chef C√©l√®bre', 'Gourmand'],
                cuisine_type: 'quebec-french',
                description: 'Martin Picard\'s famous restaurant featuring indulgent Quebecois cuisine with foie gras, duck fat, and creative poutine variations.',
                descriptionF: 'Restaurant c√©l√®bre de Martin Picard proposant une cuisine qu√©b√©coise gourmande avec foie gras, gras de canard et variations cr√©atives de poutine.',
                address: '536 Avenue Duluth E, Montreal, QC H2L 1A9',
                phone: '(514) 281-1114',
                winterFeatures: ['Rich Winter Menu', 'Comfort Food', 'Warm Ambiance'],
                winterFeaturesF: ['Menu d\'Hiver Riche', 'Nourriture R√©confortante', 'Ambiance Chaleureuse']
            },
            
            // Calgary Restaurants
            {
                id: 8,
                name: 'Caesar\'s Steakhouse',
                nameF: 'Steakhouse Caesar\'s',
                cuisine: 'Alberta Steakhouse',
                cuisineF: 'Steakhouse de l\'Alberta',
                city: 'calgary',
                rating: 4.6,
                reviewCount: 1845,
                priceRange: 'CAD $60-110',
                image: 'https://images.unsplash.com/photo-1546833999-b9f581a1996d?w=400&h=300&fit=crop',
                features: ['AAA Alberta Beef', 'Caesar Cocktails', 'Western Atmosphere', 'Live Music'],
                featuresF: ['B≈ìuf AAA de l\'Alberta', 'Cocktails C√©sar', 'Atmosph√®re Western', 'Musique Live'],
                badges: ['Premium Beef', 'Western'],
                badgesF: ['B≈ìuf Haut de Gamme', 'Western'],
                cuisine_type: 'prairie',
                description: 'Classic Alberta steakhouse specializing in AAA Alberta beef, famous Caesar cocktails, and authentic western Canadian hospitality.',
                descriptionF: 'Steakhouse classique de l\'Alberta sp√©cialis√© dans le b≈ìuf AAA de l\'Alberta, les c√©l√®bres cocktails C√©sar et l\'hospitalit√© authentique de l\'ouest canadien.',
                address: '512 4th Ave SW, Calgary, AB T2P 0J9',
                phone: '(403) 264-1222',
                winterFeatures: ['Hearty Steaks', 'Warm Interior', 'Comfort Classics'],
                winterFeaturesF: ['Steaks Copieux', 'Int√©rieur Chaleureux', 'Classiques R√©confortants']
            },
            
            // Halifax Restaurants
            {
                id: 9,
                name: 'The Bicycle Thief',
                nameF: 'Le Voleur de Bicyclette',
                cuisine: 'Maritime Italian',
                cuisineF: 'Italien Maritime',
                city: 'halifax',
                rating: 4.8,
                reviewCount: 967,
                priceRange: 'CAD $40-75',
                image: 'https://images.unsplash.com/photo-1551218808-94e220e084d2?w=400&h=300&fit=crop',
                features: ['Waterfront Dining', 'Fresh Seafood', 'Italian-Canadian Fusion', 'Patio Dining'],
                featuresF: ['D√Æner au Bord de l\'Eau', 'Fruits de Mer Frais', 'Fusion Italo-Canadienne', 'Terrasse'],
                badges: ['Waterfront', 'Fusion'],
                badgesF: ['Bord de l\'Eau', 'Fusion'],
                cuisine_type: 'maritime',
                description: 'Waterfront restaurant combining Italian cuisine with fresh Maritime seafood, featuring lobster pasta and Atlantic scallops.',
                descriptionF: 'Restaurant au bord de l\'eau combinant cuisine italienne et fruits de mer frais des Maritimes, proposant p√¢tes au homard et p√©toncles de l\'Atlantique.',
                address: '1475 Lower Water St, Halifax, NS B3J 3Z2',
                phone: '(902) 425-7993',
                winterFeatures: ['Indoor Dining', 'Hearty Pasta', 'Warm Service'],
                winterFeaturesF: ['D√Æner Int√©rieur', 'P√¢tes Copieuses', 'Service Chaleureux']
            },
            
            // Multicultural Restaurants
            {
                id: 10,
                name: 'Little India Restaurant',
                nameF: 'Restaurant Little India',
                cuisine: 'Indian-Canadian',
                cuisineF: 'Indo-Canadien',
                city: 'toronto',
                rating: 4.5,
                reviewCount: 2341,
                priceRange: 'CAD $20-40',
                image: 'https://images.unsplash.com/photo-1585937421612-70a008356fbe?w=400&h=300&fit=crop',
                features: ['Halal Options', 'Vegetarian Friendly', 'Spice Levels', 'Family Style'],
                featuresF: ['Options Halal', 'V√©g√©tarien Friendly', 'Niveaux d\'√âpices', 'Style Familial'],
                badges: ['Halal', 'Authentic'],
                badgesF: ['Halal', 'Authentique'],
                cuisine_type: 'multicultural',
                description: 'Authentic Indian cuisine adapted for Canadian tastes, featuring traditional curries, tandoor specialties, and vegetarian options.',
                descriptionF: 'Cuisine indienne authentique adapt√©e aux go√ªts canadiens, proposant currys traditionnels, sp√©cialit√©s tandoor et options v√©g√©tariennes.',
                address: '1334 Gerrard Street E, Toronto, ON M4L 1Y7',
                phone: '(416) 461-3472',
                winterFeatures: ['Spicy Warmth', 'Hot Curries', 'Comfort Spices'],
                winterFeaturesF: ['Chaleur √âpic√©e', 'Currys Chauds', '√âpices R√©confortantes']
            }
        ];
    }
    
    // ËÆæÁΩÆ‰∫ã‰ª∂ÁõëÂê¨Âô®
    setupEventListeners() {
        // Á≠õÈÄâËäØÁâá‰∫ã‰ª∂
        document.querySelectorAll('.filter-chip').forEach(chip => {
            chip.addEventListener('click', (e) => {
                document.querySelectorAll('.filter-chip').forEach(c => c.classList.remove('active'));
                e.target.classList.add('active');
                this.filters.cuisine = e.target.dataset.filter;
                this.renderRestaurants();
            });
        });
        
        // ÊêúÁ¥¢‰∫ã‰ª∂
        document.getElementById('searchInput').addEventListener('input', (e) => {
            this.handleSearch(e.target.value);
        });
        
        // Â∫ïÈÉ®ÂØºËà™‰∫ã‰ª∂
        document.querySelectorAll('.nav-item').forEach(item => {
            item.addEventListener('click', () => {
                document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
                item.classList.add('active');
            });
        });
    }
    
    // ËØ≠Ë®ÄÂàáÊç¢
    toggleLanguage() {
        this.currentLanguage = this.currentLanguage === 'en' ? 'fr' : 'en';
        document.getElementById('currentLang').textContent = this.currentLanguage.toUpperCase();
        this.updateTranslations();
        this.renderRestaurants();
    }
    
    // Êõ¥Êñ∞ÁøªËØë
    updateTranslations() {
        document.querySelectorAll('[data-en]').forEach(element => {
            const enText = element.getAttribute('data-en');
            const frText = element.getAttribute('data-fr');
            if (this.currentLanguage === 'fr' && frText) {
                if (element.tagName === 'INPUT') {
                    element.placeholder = frText;
                } else {
                    element.textContent = frText;
                }
            } else if (enText) {
                if (element.tagName === 'INPUT') {
                    element.placeholder = enText;
                } else {
                    element.textContent = enText;
                }
            }
        });
        
        // Êõ¥Êñ∞È°µÈù¢Ê†áÈ¢ò
        const titleKey = 'Discover Canada\'s Best Restaurants';
        document.title = this.translations[this.currentLanguage][titleKey] || titleKey;
    }
    
    // ÂüéÂ∏ÇÂàáÊç¢
    changeCity(city) {
        this.currentCity = city;
        this.renderRestaurants();
        this.updateWeather();
    }
    
    // Êõ¥Êñ∞Â§©Ê∞î‰ø°ÊÅØ
    updateWeather() {
        const weatherTemps = {
            'toronto': '-8¬∞C',
            'vancouver': '4¬∞C',
            'montreal': '-12¬∞C',
            'calgary': '-15¬∞C',
            'ottawa': '-10¬∞C',
            'edmonton': '-18¬∞C',
            'winnipeg': '-20¬∞C',
            'quebec': '-14¬∞C',
            'halifax': '2¬∞C'
        };
        
        document.getElementById('weatherTemp').textContent = weatherTemps[this.currentCity] || '-5¬∞C';
    }
    
    // Ê∏≤ÊüìÈ§êÂéÖÂàóË°®
    renderRestaurants() {
        const container = document.getElementById('restaurantsList');
        let filteredRestaurants = this.restaurants.filter(restaurant => {
            // ÂüéÂ∏ÇÁ≠õÈÄâ
            if (restaurant.city !== this.currentCity) return false;
            
            // ËèúÁ≥ªÁ≠õÈÄâ
            if (this.filters.cuisine !== 'all') {
                if (this.filters.cuisine === 'canadian' && !restaurant.cuisine_type.includes('canadian')) return false;
                if (this.filters.cuisine === 'poutine' && !restaurant.features.some(f => f.toLowerCase().includes('poutine'))) return false;
                if (this.filters.cuisine === 'maple' && !restaurant.features.some(f => f.toLowerCase().includes('maple'))) return false;
                if (this.filters.cuisine === 'winter-warm' && !restaurant.winterFeatures) return false;
                if (this.filters.cuisine === 'halal' && !restaurant.features.some(f => f.toLowerCase().includes('halal'))) return false;
            }
            
            return true;
        });
        
        container.innerHTML = '';
        
        filteredRestaurants.forEach(restaurant => {
            const card = this.createRestaurantCard(restaurant);
            container.appendChild(card);
        });
        
        if (filteredRestaurants.length === 0) {
            container.innerHTML = `
                <div class="no-results">
                    <i class="fas fa-search" style="font-size: 3rem; color: var(--light-text); margin-bottom: 1rem;"></i>
                    <h3 style="color: var(--medium-text);">${this.currentLanguage === 'fr' ? 'Aucun restaurant trouv√©' : 'No restaurants found'}</h3>
                    <p style="color: var(--light-text);">${this.currentLanguage === 'fr' ? 'Essayez de modifier vos filtres de recherche.' : 'Try adjusting your search filters.'}</p>
                </div>
            `;
        }
    }
    
    // ÂàõÂª∫È§êÂéÖÂç°Áâá
    createRestaurantCard(restaurant) {
        const card = document.createElement('div');
        card.className = 'restaurant-card';
        card.onclick = () => this.showRestaurantDetails(restaurant.id);
        
        const name = this.currentLanguage === 'fr' && restaurant.nameF ? restaurant.nameF : restaurant.name;
        const cuisine = this.currentLanguage === 'fr' && restaurant.cuisineF ? restaurant.cuisineF : restaurant.cuisine;
        const description = this.currentLanguage === 'fr' && restaurant.descriptionF ? restaurant.descriptionF : restaurant.description;
        const features = this.currentLanguage === 'fr' && restaurant.featuresF ? restaurant.featuresF : restaurant.features;
        const badges = this.currentLanguage === 'fr' && restaurant.badgesF ? restaurant.badgesF : restaurant.badges;
        const winterFeatures = this.currentLanguage === 'fr' && restaurant.winterFeaturesF ? restaurant.winterFeaturesF : restaurant.winterFeatures;
        
        const isFavorite = this.favorites.has(restaurant.id);
        
        card.innerHTML = `
            <div class="restaurant-header">
                <img src="${restaurant.image}" alt="${name}" class="restaurant-image">
                <div class="restaurant-badges">
                    ${badges.map(badge => `<div class="card-badge">${badge}</div>`).join('')}
                    ${winterFeatures ? '<div class="card-badge seasonal"><i class="fas fa-snowflake"></i> Winter Ready</div>' : ''}
                </div>
                <button class="restaurant-favorite ${isFavorite ? 'active' : ''}" onclick="event.stopPropagation(); app.toggleFavorite(${restaurant.id})">
                    <i class="fas fa-heart"></i>
                </button>
            </div>
            <div class="restaurant-content">
                <div class="restaurant-title">
                    <div>
                        <h3 class="restaurant-name">${name}</h3>
                        <p class="restaurant-cuisine">${cuisine}</p>
                    </div>
                    <div class="restaurant-rating">
                        <i class="fas fa-star"></i>
                        ${restaurant.rating}
                    </div>
                </div>
                <div class="restaurant-info">
                    <div class="info-item">
                        <i class="fas fa-dollar-sign"></i>
                        <span>${restaurant.priceRange}</span>
                    </div>
                    <div class="info-item">
                        <i class="fas fa-users"></i>
                        <span>${restaurant.reviewCount} reviews</span>
                    </div>
                    <div class="info-item">
                        <i class="fas fa-phone"></i>
                        <span>${restaurant.phone}</span>
                    </div>
                    <div class="info-item">
                        <i class="fas fa-snowflake"></i>
                        <span>${this.currentLanguage === 'fr' ? 'Pr√™t pour l\'hiver' : 'Winter Ready'}</span>
                    </div>
                </div>
                <p style="color: var(--medium-text); font-size: var(--font-sm); margin: var(--spacing-md) 0; line-height: 1.5;">
                    ${description.substring(0, 120)}...
                </p>
                <div class="restaurant-features">
                    ${features.slice(0, 3).map(feature => `<span class="feature-tag">${feature}</span>`).join('')}
                    ${winterFeatures ? `<span class="feature-tag winter-feature"><i class="fas fa-snowflake"></i> ${winterFeatures[0]}</span>` : ''}
                </div>
                <div class="restaurant-actions">
                    <button class="btn btn-secondary" onclick="event.stopPropagation(); app.callRestaurant('${restaurant.phone}')">
                        <i class="fas fa-phone"></i> ${this.currentLanguage === 'fr' ? 'Appeler' : 'Call'}
                    </button>
                    <button class="btn btn-primary" onclick="event.stopPropagation(); app.bookRestaurant(${restaurant.id})">
                        <i class="fas fa-calendar-plus"></i> ${this.currentLanguage === 'fr' ? 'R√©server' : 'Book'}
                    </button>
                </div>
            </div>
        `;
        
        return card;
    }
    
    // ÊòæÁ§∫È§êÂéÖËØ¶ÊÉÖ
    showRestaurantDetails(restaurantId) {
        const restaurant = this.restaurants.find(r => r.id === restaurantId);
        if (!restaurant) return;
        
        const modal = document.getElementById('restaurantModal');
        const content = modal.querySelector('.modal-content');
        
        const name = this.currentLanguage === 'fr' && restaurant.nameF ? restaurant.nameF : restaurant.name;
        const cuisine = this.currentLanguage === 'fr' && restaurant.cuisineF ? restaurant.cuisineF : restaurant.cuisine;
        const description = this.currentLanguage === 'fr' && restaurant.descriptionF ? restaurant.descriptionF : restaurant.description;
        const features = this.currentLanguage === 'fr' && restaurant.featuresF ? restaurant.featuresF : restaurant.features;
        const winterFeatures = this.currentLanguage === 'fr' && restaurant.winterFeaturesF ? restaurant.winterFeaturesF : restaurant.winterFeatures;
        
        content.innerHTML = `
            <div class="modal-header">
                <button class="close-btn" onclick="app.closeModal()">&times;</button>
            </div>
            <div class="restaurant-detail-image">
                <img src="${restaurant.image}" alt="${name}">
            </div>
            <div class="restaurant-detail-content">
                <h2>${name}</h2>
                <p class="cuisine">${cuisine}</p>
                <div class="rating">
                    <i class="fas fa-star"></i>
                    ${restaurant.rating} (${restaurant.reviewCount} ${this.currentLanguage === 'fr' ? 'avis' : 'reviews'})
                </div>
                <p class="description">${description}</p>
                
                <div class="details-section">
                    <h3><i class="fas fa-info-circle"></i> ${this.currentLanguage === 'fr' ? 'Informations' : 'Information'}</h3>
                    <div class="details-grid">
                        <div><strong>${this.currentLanguage === 'fr' ? 'Prix' : 'Price'}:</strong> ${restaurant.priceRange}</div>
                        <div><strong>${this.currentLanguage === 'fr' ? 'T√©l√©phone' : 'Phone'}:</strong> ${restaurant.phone}</div>
                        <div><strong>${this.currentLanguage === 'fr' ? 'Adresse' : 'Address'}:</strong> ${restaurant.address}</div>
                    </div>
                </div>
                
                <div class="details-section">
                    <h3><i class="fas fa-star"></i> ${this.currentLanguage === 'fr' ? 'Caract√©ristiques' : 'Features'}</h3>
                    <div class="features-list">
                        ${features.map(feature => `<span class="feature-tag">${feature}</span>`).join('')}
                    </div>
                </div>
                
                ${winterFeatures ? `
                    <div class="details-section winter-section">
                        <h3><i class="fas fa-snowflake"></i> ${this.currentLanguage === 'fr' ? 'Sp√©cialit√©s d\'Hiver' : 'Winter Specialties'}</h3>
                        <div class="features-list">
                            ${winterFeatures.map(feature => `<span class="feature-tag winter-feature">${feature}</span>`).join('')}
                        </div>
                    </div>
                ` : ''}
                
                <div class="modal-actions">
                    <button class="btn btn-secondary" onclick="app.callRestaurant('${restaurant.phone}')">
                        <i class="fas fa-phone"></i> ${this.currentLanguage === 'fr' ? 'Appeler' : 'Call'}
                    </button>
                    <button class="btn btn-primary" onclick="app.bookRestaurant(${restaurant.id})">
                        <i class="fas fa-calendar-plus"></i> ${this.currentLanguage === 'fr' ? 'R√©server' : 'Book Now'}
                    </button>
                </div>
            </div>
        `;
        
        modal.classList.add('show');
    }
    
    // ÂÖ≥Èó≠Ê®°ÊÄÅÊ°Ü
    closeModal() {
        document.querySelectorAll('.modal').forEach(modal => {
            modal.classList.remove('show');
        });
    }
    
    // ÂàáÊç¢Êî∂ËóèÁä∂ÊÄÅ
    toggleFavorite(restaurantId) {
        if (this.favorites.has(restaurantId)) {
            this.favorites.delete(restaurantId);
        } else {
            this.favorites.add(restaurantId);
        }
        
        // Êõ¥Êñ∞UI
        document.querySelectorAll(`.restaurant-favorite`).forEach(btn => {
            if (btn.onclick.toString().includes(`${restaurantId}`)) {
                btn.classList.toggle('active', this.favorites.has(restaurantId));
            }
        });
        
        // ‰øùÂ≠òÂà∞Êú¨Âú∞Â≠òÂÇ®
        localStorage.setItem('mapleFavorites', JSON.stringify([...this.favorites]));
        
        this.showNotification(
            this.favorites.has(restaurantId) ? 
            (this.currentLanguage === 'fr' ? 'Ajout√© aux favoris' : 'Added to favorites') :
            (this.currentLanguage === 'fr' ? 'Retir√© des favoris' : 'Removed from favorites')
        );
    }
    
    // È¢ÑËÆ¢È§êÂéÖ
    bookRestaurant(restaurantId) {
        const restaurant = this.restaurants.find(r => r.id === restaurantId);
        if (!restaurant) return;
        
        const message = this.currentLanguage === 'fr' ? 
            `R√©server une table chez ${restaurant.nameF || restaurant.name}?` :
            `Book a table at ${restaurant.name}?`;
            
        if (confirm(message)) {
            this.showNotification(
                this.currentLanguage === 'fr' ? 
                'Redirection vers la r√©servation...' : 
                'Redirecting to booking...'
            );
            
            // Âú®ÁúüÂÆûÂ∫îÁî®‰∏≠ÔºåËøôÈáå‰ºöË∑≥ËΩ¨Âà∞È¢ÑËÆ¢È°µÈù¢
            setTimeout(() => {
                this.showNotification(
                    this.currentLanguage === 'fr' ? 
                    'Fonction de r√©servation bient√¥t disponible!' : 
                    'Booking feature coming soon!'
                );
            }, 1500);
        }
    }
    
    // Êã®ÊâìÁîµËØù
    callRestaurant(phone) {
        if (confirm(`Call ${phone}?`)) {
            window.location.href = `tel:${phone}`;
        }
    }
    
    // ÊêúÁ¥¢Â§ÑÁêÜ
    handleSearch(query) {
        if (!query || query.length < 2) {
            this.renderRestaurants();
            return;
        }
        
        const filtered = this.restaurants.filter(restaurant => {
            const searchText = `
                ${restaurant.name} 
                ${restaurant.nameF || ''} 
                ${restaurant.cuisine} 
                ${restaurant.cuisineF || ''} 
                ${restaurant.description} 
                ${restaurant.descriptionF || ''}
                ${restaurant.features.join(' ')}
                ${restaurant.featuresF ? restaurant.featuresF.join(' ') : ''}
            `.toLowerCase();
            
            return searchText.includes(query.toLowerCase()) && restaurant.city === this.currentCity;
        });
        
        this.renderFilteredRestaurants(filtered);
    }
    
    // Ê∏≤ÊüìÁ≠õÈÄâÂêéÁöÑÈ§êÂéÖ
    renderFilteredRestaurants(restaurants) {
        const container = document.getElementById('restaurantsList');
        container.innerHTML = '';
        
        restaurants.forEach(restaurant => {
            const card = this.createRestaurantCard(restaurant);
            container.appendChild(card);
        });
        
        if (restaurants.length === 0) {
            container.innerHTML = `
                <div class="no-results" style="text-align: center; padding: 3rem 1rem;">
                    <i class="fas fa-search" style="font-size: 3rem; color: var(--light-text); margin-bottom: 1rem;"></i>
                    <h3 style="color: var(--medium-text);">${this.currentLanguage === 'fr' ? 'Aucun restaurant trouv√©' : 'No restaurants found'}</h3>
                    <p style="color: var(--light-text);">${this.currentLanguage === 'fr' ? 'Essayez de modifier vos termes de recherche.' : 'Try adjusting your search terms.'}</p>
                </div>
            `;
        }
    }
    
    // ÊòæÁ§∫ÈÄöÁü•
    showNotification(message, type = 'info') {
        const notification = document.createElement('div');
        notification.className = 'notification';
        notification.style.cssText = `
            position: fixed;
            top: 100px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--canadian-red);
            color: white;
            padding: 1rem 1.5rem;
            border-radius: 25px;
            box-shadow: var(--shadow);
            z-index: 4000;
            font-weight: 600;
            animation: slideInDown 0.3s ease;
        `;
        notification.textContent = message;
        
        document.body.appendChild(notification);
        
        setTimeout(() => {
            notification.style.animation = 'slideOutUp 0.3s ease forwards';
            setTimeout(() => notification.remove(), 300);
        }, 3000);
    }
    
    // ËØ≠Èü≥ÊêúÁ¥¢
    startVoiceSearch() {
        if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
            const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
            recognition.lang = this.currentLanguage === 'fr' ? 'fr-CA' : 'en-CA';
            recognition.continuous = false;
            recognition.interimResults = false;
            
            recognition.onstart = () => {
                this.showNotification(
                    this.currentLanguage === 'fr' ? '√âcoute en cours...' : 'Listening...'
                );
            };
            
            recognition.onresult = (event) => {
                const transcript = event.results[0][0].transcript;
                document.getElementById('searchInput').value = transcript;
                this.handleSearch(transcript);
            };
            
            recognition.onerror = () => {
                this.showNotification(
                    this.currentLanguage === 'fr' ? 'Erreur de reconnaissance vocale' : 'Voice recognition error'
                );
            };
            
            recognition.start();
        } else {
            this.showNotification(
                this.currentLanguage === 'fr' ? 'Reconnaissance vocale non support√©e' : 'Voice recognition not supported'
            );
        }
    }
    
    // ÊåâÂàÜÁ±ªÁ≠õÈÄâ
    filterByCategory(category) {
        this.filters.cuisine_type = category;
        const filtered = this.restaurants.filter(restaurant => 
            restaurant.cuisine_type === category && restaurant.city === this.currentCity
        );
        this.renderFilteredRestaurants(filtered);
    }
    
    // Âä†ËΩΩÊõ¥Â§öÈ§êÂéÖ
    loadMoreRestaurants() {
        this.showNotification(
            this.currentLanguage === 'fr' ? 'Chargement de plus de restaurants...' : 'Loading more restaurants...'
        );
        
        // Ê®°ÊãüÂä†ËΩΩÂª∂Ëøü
        setTimeout(() => {
            this.showNotification(
                this.currentLanguage === 'fr' ? 'Tous les restaurants charg√©s!' : 'All restaurants loaded!'
            );
        }, 1500);
    }
    
    // ÊòæÁ§∫Â§©Ê∞î‰ø°ÊÅØ
    showWeather() {
        const weatherInfo = {
            'toronto': { temp: '-8¬∞C', condition: 'Snowy', icon: 'fas fa-snowflake' },
            'vancouver': { temp: '4¬∞C', condition: 'Rainy', icon: 'fas fa-cloud-rain' },
            'montreal': { temp: '-12¬∞C', condition: 'Very Cold', icon: 'fas fa-snowflake' },
            'calgary': { temp: '-15¬∞C', condition: 'Snowy', icon: 'fas fa-snowflake' },
            'halifax': { temp: '2¬∞C', condition: 'Cloudy', icon: 'fas fa-cloud' }
        };
        
        const weather = weatherInfo[this.currentCity];
        const message = this.currentLanguage === 'fr' ? 
            `${weather.temp} - ${weather.condition === 'Snowy' ? 'Neigeux' : weather.condition === 'Rainy' ? 'Pluvieux' : weather.condition === 'Very Cold' ? 'Tr√®s Froid' : 'Nuageux'}` :
            `${weather.temp} - ${weather.condition}`;
            
        this.showNotification(`Weather: ${message}`);
    }
}

// ÂÖ®Â±ÄÂáΩÊï∞
function toggleLanguage() {
    app.toggleLanguage();
}

// ÂïÜÂÆ∂ËÆ§ËØÅÂíåÂπøÂëäÁõ∏ÂÖ≥ÂáΩÊï∞
function goToMerchantAuth() {
    window.location.href = 'merchant-auth.html';
}

function viewPromotedRestaurant(promotionId) {
    // ËÆ∞ÂΩïÂπøÂëäÁÇπÂáª
    console.log('Promoted restaurant clicked:', promotionId);
    
    // Ê®°ÊãüË∑≥ËΩ¨Âà∞Êé®ÂπøÈ§êÂéÖËØ¶ÊÉÖ
    const promotedRestaurants = {
        'premium-1': {
            id: 'the-keg-steakhouse',
            name: 'The Keg Steakhouse',
            cuisine: 'Premium Canadian Steaks',
            isPromoted: true,
            promotionType: 'premium'
        },
        'standard-1': {
            id: 'cn-tower-360',
            name: 'CN Tower 360 Restaurant',
            cuisine: 'Fine Dining Experience',
            isPromoted: true,
            promotionType: 'standard'
        },
        'standard-2': {
            id: 'schwartz-deli',
            name: 'Schwartz\'s Deli',
            cuisine: 'Authentic Montreal Smoked Meat',
            isPromoted: true,
            promotionType: 'standard'
        }
    };
    
    const restaurant = promotedRestaurants[promotionId];
    if (restaurant) {
        // ËøôÈáåÂèØ‰ª•ÊòæÁ§∫È§êÂéÖËØ¶ÊÉÖÊàñË∑≥ËΩ¨Âà∞È¢ÑËÆ¢È°µÈù¢
        app.showRestaurantDetails(restaurant);
    }
}

function showWinterGuide() {
    // ÊòæÁ§∫ÂÜ¨Â≠£È§êÂéÖÊåáÂçó
    console.log('Winter dining guide requested');
    app.showNotification(
        app.currentLanguage === 'fr' ? 
        'Guide d\'hiver bient√¥t disponible!' : 
        'Winter guide coming soon!',
        'info'
    );
}

function changeCity(city) {
    app.changeCity(city);
}

function handleSearch() {
    const query = document.getElementById('searchInput').value;
    app.handleSearch(query);
}

function startVoiceSearch() {
    app.startVoiceSearch();
}

function showWeather() {
    app.showWeather();
}

function filterByCategory(category) {
    app.filterByCategory(category);
}

function loadMoreRestaurants() {
    app.loadMoreRestaurants();
}

function showFilters() {
    document.getElementById('filtersPanel').classList.add('show');
}

function closeFilters() {
    document.getElementById('filtersPanel').classList.remove('show');
}

function switchTab(tab) {
    // Â∫ïÈÉ®ÂØºËà™ÂàáÊç¢ÈÄªËæë
    console.log(`Switching to ${tab} tab`);
}

// ÂàùÂßãÂåñÂ∫îÁî®
let app;
document.addEventListener('DOMContentLoaded', () => {
    app = new MapleTableApp();
});

// PWA ÊîØÊåÅ
if ('serviceWorker' in navigator) {
    window.addEventListener('load', () => {
        navigator.serviceWorker.register('/sw.js')
            .then((registration) => {
                console.log('SW registered: ', registration);
            })
            .catch((registrationError) => {
                console.log('SW registration failed: ', registrationError);
            });
    });
}